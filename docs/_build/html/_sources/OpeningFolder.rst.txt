Loading Tissue images
_____________________

Image Specifications and Fluorescent Staining
##############################################

An important step in the image processing done by AtlasXbrowser, is the location of the ROI (Region of Interest) of the image, corresponding to the section
of tissue which the A and B chips overlap. This is made much easier by flowing Bovine Serum Albumin (BSA) solution mixed with 
fluorescent dye through the outside channels of both the A and B chips. These fluorescent colors will make is visually very
clear where the overlap of the two chips are, it is will be enclosed by this colored square.

*Note:* We reccomend using two different colors of fluorescent dye on each chip to allow for easy orientation
of the image once it has been rotated.

The two images required for processing are the BSA and postB images. These can be taken following the removal of the B chip, and after fluorescently stained BSA
is flown through the outside channels of the chips.

**BSA Image:** Image taken using the epifluorescence setting of the microscope.

**postB Image:** Image taken using the brightfield setting of the microscope.

    .. figure:: /images/Both_images.png
       
       (Left) The postB image, (Right) the BSA image. Notice how they are the same underlying image. Also note in the 
       BSA image how the fluorescent staining of two different colors allows for easy identification of proper orientation
       following any rotations that may occur from this point on.


Image Folder Specifications
###########################

To use AtlasXbrowser for image processing, a proper image folder must be prepared.
The folder to be used in the Browser contains both the **BSA Image** and the **postB Image**.

While these files can be named whatever the user wants, they two images must be stored within the same folder, we highly reccomend creating a 
new folder pertaining this particular run which will store these two images, and the relevant folders and files generated by AtlasXbrowser.

    .. image:: /images/FolderCreated.png

See above how a new folder was created, storing the BSA and postB images to be used by AtlasXbrowser.

Specifying Barcode Folder
#########################

Knowing the nucleotide sequence corresponding to each channel in both and A and B chip is essential. To allow
for this AtlasXbrowser requires the loading of a Barcode File. This is a .txt file that contains the unique barcode identifer
for each unique nucleotide barcode sequence.

    .. image:: /images/barcodefile.png

Above is an example of a barcode file for a DBiT run using 50 channel chips. As such there are 2500 lines, each one corresponding to the unique 16 nucleotides
that define each tixel. With 8 of these coming from the one channel on the A chip and 8 coming from a channel on the B chip.

The file used above can is named "bc50v1.txt" and be found on the AtlasXbrowser `Github`_. 

Loading Image and Entering Metadata
###################################
In order to begin processing the tissue image, the relevant images must be loaded in.

#. Navigate to the *File* tab in the top left corner of the screen.

    .. figure:: /images/SelectingFile.png 

#. Select "Begin Image Processing".

    .. figure:: /images/BeginImageProcessing.png

#. Once selected a pop-up window should appear on screen.

    .. figure:: /images/OpeningImage_selectingMeta.png

**1.)** Select **File** in the first row of the pop-up titled, "Select BSA Image". Then navigate to the directory 
of the image folder, and select the BSA image.

**2.)** Select **File** in the second row, labeled "Select postB Image". Navigate to the image folder, and select the postB image.

**3.)** Select **File** in the third row, labeled "Select Barcode File". Navigate to and select the desired barcode file.

*Note:** While the barcode file does not need to be stored in the same image folder, it can be helpful to place it there for ease of navigation.

**4.)** Enter the desired name of the run in the textbox.

**5.)** Once the images have been loaded in without error, and the run ID entered, select **Submit** to continue with the image processing.

Upon selecting **Submit**, the popup should dissapear and the BSA image loaded into the main window of the Browser.

This metadata will be saved and stored in the associated Spatial Folder for this experiment.
Now we can proceed to configuring the image.


.. _Github: https://github.com/atlasxomics/AtlasXbrowser.git